<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADEM Studio - Persona</title>
    <link rel="icon" href="static/img/adem-img/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  
  
    <style>
        /* Ajustes generales */
        body {
            margin: 0;
            padding: 0;
            background: var(--bunker-900);
        }
    
        /* Sidebar mejorado */
        .left-column {
        position: fixed;
        left: 0;
        top: 60px;
        height: calc(100vh - 60px);
        width: 300px;
        background: var(--bunker-900);
        padding: 20px;
        transition: transform 0.3s ease;
        overflow-y: auto;
        z-index: 310;
        opacity: 1;
        transform: none;
    }
        /* Contenido principal ajustado */
        .main-content {
            padding-top: 60px;
            margin-left: 300px;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            width: calc(100% - 300px);
            display: block;
        }
    
        .center-column {
            padding: 20px;
    width: 100%;
    height: calc(100vh - 60px);
    overflow-y: auto;
    display: flex;
    flex-wrap: wrap;
    flex-direction: row;
    justify-content: flex-start;
    align-content: flex-start;
        }
    
        .loaded img {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        /* Header mejorado */
        .simple-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            padding: 0 20px;
            background: var(--bunker-900);
            border-bottom: 1px solid var(--bunker-700);
            display: flex;
            align-items: center;
            z-index: 20;
        }
    
        /* Preview grid mejorado */
        .preview-grid {
            display: block;
            padding: 8px;
            width: auto;
             /* Alinea desde la izquierda */
            max-width: 100%;
            margin: 0;
            min-width: 200px;
        }
    
        .preview-box {
            width: 360px;
            height: 360px;
            display: block;
            background: var(--bunker-800);
            border: 1px solid var(--bunker-600);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
    
        /* Film selector con caret */
        .film-selector {
            position: relative;
            appearance: none;
            -webkit-appearance: none;
            padding-right: 32px !important;
        }
        
        .film-selector-wrapper {
        position: relative;
        width: 100%;
        background: var(--bunker-800);
        padding: var(--3xs);
        border-radius: var(--2xs);
    }
        
        .film-selector-wrapper:after {
            content: "expand_more";
            font-family: 'Material Symbols Outlined';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--bunker-400);
            pointer-events: none;
        }
    
        /* AI toggle reposicionado */
         /* Switch de AI */
         .ai-toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 16px 0;
            padding: 8px 12px;
            background: var(--bunker-800);
            border-radius: 8px;
        }
    
        .toggle-switch {
            position: relative;
            width: 46px;
            height: 24px;
        }
    /*saving tes*/
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
    
        .toggle-switch label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bunker-700);
            transition: .4s;
            border-radius: 34px;
        }
    
        .toggle-switch label:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
    
        .toggle-switch input:checked + label {
            background-color: var(--aztec-600);
        }
    
        .toggle-switch input:checked + label:before {
            transform: translateX(22px);
        }
    
        /* Texto del switch */
        .ai-toggle-container span {
            color: var(--bunker-100);
            font-size: 14px;
        }
    
        /* Estados responsive */
        .left-column.hidden {
            transform: translateX(-300px);
        }
        
        .main-content.full-width {
            margin-left: 0;
            width: 100%;
        }
    
    
        .prompt-input-group {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    
    .prompt-wrapper {
        height: auto;
        min-height: 200px;
        width: 100%;
        border-radius: var(--xs);
        overflow: hidden;
    }
    
    textarea#personaPrompt {
        height: auto;
        background: var(--bunker-800);
        min-height: 200px;
        width: 100%;
        position: relative;
    }
    
    .prompt-container {
        width: 100%;
    }
    
    
    
    .prompt-input-group {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    
    .prompt-wrapper {
        height: auto;
        min-height: 200px;
        width: 100%;
        border-radius: var(--xs);
        overflow: hidden;
    }

    prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.copy-button {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    padding: 8px;
    border-radius: 4px;
    transition: background 0.2s;
}

.copy-button:hover {
    background: var(--bunker-700);
}


    
    textarea#personaPrompt {
        height: auto;
        background: var(--bunker-800);
        min-height: 200px;
        width: 100%;
        position: relative;
    }
    
    .prompt-container {
        width: 100%;
    }
    
    select#film_type {
        display: block;
        margin: 0;
        background: none;
        border: none;
        width: 100%;
        padding-left: 32px;
    }
    
    button#createPersona {
        font-size: medium;
    width: 100%;
    margin: 24px 0 0 0;
    background: var(--aztec-600);
    color: white;
    border: none;
    padding: var(--s);
    }
    
    .loaded img {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }
    
    div#preview { 
    display: none;
}

.preview-placeholder {
    display: none;
}

.spinner-container {
    background: var(--bunker-800);
}
        /* Ajuste responsive */
        @media (max-width: 1600px) {
            .preview-box {
                 
                height: auto;
                aspect-ratio: 1;
            }
        }
    
        @media (max-width: 1024px) {
            .preview-box {
                width: 100%;
                height: auto;
                aspect-ratio: 1;
            }
        }

        .preview-box {
    position: relative;
}

.image-controls {
    position: absolute;
    bottom: 10px;
    right: 10px;
    display: flex;
    gap: 8px;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease;
    background: rgba(0, 0, 0, 0.5);
    padding: 5px;
    border-radius: 12px;
}

.preview-box:hover .image-controls {
    opacity: 1;
}

.control-button {
    background: transparent;
    border: none;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: white;
    transition: transform 0.2s ease;
    position: relative;
    padding: 0;
    margin: 0;
}

.control-button:hover {
    transform: scale(1.1);
}



.control-button:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 35px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
}

/* Modales */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.modal.active {
    display: flex;
    opacity: 1;
}

.modal-content {
    background: var(--bunker-900);
    border-radius: 12px;
    padding: 24px;
    margin: auto;
    max-width: 90%;
    max-height: 90%;
    position: relative;
    overflow: auto;
}

.modal-close {
    position: absolute;
    top: 0px;
    right: 0px;
    background: none;
    border: none;
    color: var(--bunker-400);
    cursor: pointer;
    font-size: 24px;
}

/* Modal específico para imagen */
.image-modal .modal-content {
    padding: 0;
    background: none;
}


.image-modal img {
    max-width: 100%;
    max-height: 90vh;
    object-fit: contain;
}

/* Modal específico para prompt */
.prompt-modal .modal-content {
    width: 600px;
    color: white;
}

.prompt-text {
    font-family: 'Courier New', monospace;
    line-height: 1.5;
    padding: 16px;
    background: var(--bunker-800);
    border-radius: 8px;
    white-space: pre-wrap;
}

/* PDF Upload styles */
.pdf-upload-container {
    margin: 0 auto var(--s);
    padding: var(--xs) 0 var(--xs) var(--xs);
    background: var(--bunker-800);
    border-radius: 8px;
    width: 100%;
}

.file-input-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
    color: var(--bunker-300);
}

.file-input-wrapper input[type="file"] {
    display: none;
}

.file-input-wrapper label {
    cursor: pointer;
    color: var(--bunker-400);
    font-size: 14px;
}

#pdfPrompt {
    margin-top: 8px;
    padding: 8px;
    background: var(--bunker-700);
    border-radius: 4px;
}

.pdf-prompt-text {
    color: var(--bunker-100);
    font-size: 12px;
    margin: 0;
}

.pdf-status {
    display: flex;
    align-items: center;
    gap: 8px;
    background: none;
    border-radius: 4px;
    color: var(--aztec-400);
    justify-content: flex-start;
    position: relative;
    padding: var(--xs);
}

.success-icon {
    color: #4CAF50;
    font-size: 18px;
}

.remove-pdf {
    background: none;
    border: none;
    color: var(--bunker-400);
    cursor: pointer;
    padding: 2px;
    display: flex;
    align-items: center;
    margin: 0;
    position: absolute;
    right: 8px;
}

.pdf-progress {
    margin: 0 0 var(--xs);
    transition: all 0.3s ease;
}

.progress-bar {
    height: 4px;
    background: var(--bunker-700);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: var(--3xs);
}

.progress-fill {
    height: 100%;
    background: var(--aztec-600);
    width: 0%;
    transition: width 0.6s ease;
}

.progress-text {
    font-size: 12px;
    color: var(--bunker-400);
    margin: 0;
    display: block;
}

.pdf-progress.success {
    background: var(--bunker-900);
    padding: var(--3xs) var(--xs);
    border-radius: var(--2xs);
}

.pdf-progress.success .progress-text {
    color: var(--aztec-400);
}

.prompt-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 12px;
}

.prompt-info p {
    color: var(--aztec-400);
    margin: 0;
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: small;
}

.prompt-info p::before {
    content: "✅";
    margin-top: 2px;
}
    </style>
    
    


</head>
<body>
    <div class="layout">
        <!-- Top Bar -->
        <header class="simple-header">
            <button class="menu-button" id="menuButton">
                <span class="material-symbols-outlined">menu</span>
            </button>
            <h1 style="margin: 0;font-size: medium;">Persona Project</h1>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <aside class="left-column">
                <h2>Generate Images</h2>
                <div class="prompt-container">
                    <div class="prompt-input-group">
                        <div class="prompt-wrapper">
                            <textarea 
                                id="personaPrompt" 
                                placeholder="Write your prompt here"
                                rows="4"
                                class="modern-input"
                            ></textarea>
                        </div>

                        <div class="ai-toggle-container">
                            <div class="toggle-switch">
                                <input type="checkbox" id="aiPrompt" checked>
                                <label for="aiPrompt"></label>
                            </div>
                            <span>AI-prompt</span>
                        </div>
                        
                        <!-- PDF Upload Section -->
                        <div class="pdf-upload-container">
                            <div class="file-input-wrapper">
                                <span class="material-symbols-outlined">description</span>
                                <input type="file" id="pdfFile" accept=".pdf">
                                <label for="pdfFile" id="pdfLabel">Upload PDF (optional)</label>
                            </div>
                            <div class="pdf-status" style="display: none;">
                                <span class="file-name"></span>
                                <span class="material-symbols-outlined success-icon">check_circle</span>
                                <button class="remove-pdf">
                                    <span class="material-symbols-outlined">close</span>
                                </button>
                            </div>
                        </div>
                        <div class="pdf-progress" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <span class="progress-text">Processing PDF...</span>
                        </div>
                        <div class="film-selector-wrapper"><span class="material-symbols-outlined" style="
                            color: var(--bunker-300);
                            position: absolute;
                            left: 8px;
                            top: 10px;
                        ">
                        camera
                        </span>
                        <select class="film-selector" id="film_type">
                            <option value="" disabled selected>Select film style</option>
                            <option value="fuji">Fuji Film</option>
                            <option value="koda">Koda Film</option>
                            <option value="pola">Pola Film</option>
                            <option value="surreal">Surreal Film</option>
                            <option value="analog">Analog Film</option>
                            <option value="disposable">Disposable Camera</option>
                            <option value="flux">Realism</option>

                        </select>
                                                </div>
                        
                        <button id="createPersona" class="generate-button">
                            Generate
                        </button>
                    </div>
                </div>
            </aside>

            <div class="center-column">
               
                <div class="preview-grid">
                    <div class="preview-box" id="preview">
                        <div class="preview-placeholder">
                            <span class="material-symbols-outlined">image</span>
                            <p>Image will be generated here</p>
                        </div>
                        <div class="spinner-container" style="display: none;">
                            <div class="spinner"></div>
                        </div>
                        <div class="image-controls">
                            <button class="control-button prompt-btn" data-tooltip="See prompt">✏️</button>
                            <button class="control-button flag-btn" data-tooltip=""></button>
                            <button class="control-button zoom-btn" data-tooltip="Zoom">🔍</button>
                            <button class="control-button download-btn" data-tooltip="Download">⬇️</button>
                            <button class="control-button remove-btn" data-tooltip="Remove">🗑️</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal info -->
<div class="modal prompt-modal">
    <div class="modal-content">
        <button class="modal-close">×</button>
        <div class="prompt-header">
            <h3>Generated Prompt</h3>
            <button class="copy-button" title="Copy prompt">📋</button>
        </div>
        <div class="prompt-text"></div>
        <div class="prompt-info"></div>
    </div>
</div>

<div class="modal image-modal">
    <div class="modal-content">
        <button class="modal-close">×</button>
        <img src="" alt="Full size image">
    </div>
</div>

    <!-- Scripts -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuButton = document.getElementById('menuButton');
            const leftColumn = document.querySelector('.left-column');
            const mainContent = document.querySelector('.main-content');
            
            menuButton?.addEventListener('click', () => {
                leftColumn.classList.toggle('hidden');
                mainContent.classList.toggle('full-width');
            });

            // Manejar el cambio en el selector de film
            const filmTypeInput = document.getElementById('film_type');
            filmTypeInput?.addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                if (selectedOption.value) {
                    const createButton = document.getElementById('createPersona');
                    createButton.disabled = false;
                } else {
                    const createButton = document.getElementById('createPersona');
                    createButton.disabled = true;
                }
            });

            // Manejar cambios en el prompt
            const promptInput = document.getElementById('personaPrompt');
            promptInput?.addEventListener('input', function() {
                if (this.value.trim() && document.getElementById('film_type').value) {
                    const createButton = document.getElementById('createPersona');
                    createButton.disabled = false;
                } else {
                    const createButton = document.getElementById('createPersona');
                    createButton.disabled = true;
                }
            });

            // Función para crear un nuevo placeholder
            function createNewPlaceholder() {
                const newGrid = document.createElement('div');
                newGrid.className = 'preview-grid';
                
                const box = document.createElement('div');
                box.className = 'preview-box';
                box.id = `preview-${Date.now()}`;
                
                box.innerHTML = `
                    <div class="preview-placeholder">
        <span class="material-symbols-outlined">image</span>
        <p>Image will be generated here</p>
    </div>
    <div class="spinner-container" style="display: none;">
        <div class="spinner"></div>
    </div>
    <div class="image-controls">
        <button class="control-button prompt-btn" data-tooltip="See prompt">✏️</button>
        <button class="control-button flag-btn" data-tooltip=""></button>
        <button class="control-button zoom-btn" data-tooltip="Zoom">🔍</button>
        <button class="control-button download-btn" data-tooltip="Download">⬇️</button>
        <button class="control-button remove-btn" data-tooltip="Remove">🗑️</button>
    </div>
    <img src="" alt="Generated image">
                `;

     
                
                newGrid.appendChild(box);
                
                const centerColumn = document.querySelector('.center-column');
                centerColumn.insertBefore(newGrid, centerColumn.firstChild.nextSibling);
                
                return newGrid;
            }
            
            // Función para generar imágenes
            async function generateImages() {
                const promptInput = document.getElementById('personaPrompt');
                const filmType = document.getElementById('film_type').value;
                const aiPromptEnabled = document.getElementById('aiPrompt').checked;
                
                const finalPrompt = promptInput.value.trim();
                
                if (!finalPrompt || !filmType) {
                    alert('Please enter a prompt and select a film type');
                    return;
                }
                
                const createButton = document.getElementById('createPersona');
                createButton.disabled = true;
                
                const newGrid = createNewPlaceholder();
                const box = newGrid.querySelector('.preview-box');
                box.querySelector('.spinner-container').style.display = 'flex';
                
                try {
                    const response = await fetch('/generate-persona', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            prompt: finalPrompt,
                            film_type: filmType,
                            use_ai_prompt: aiPromptEnabled
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.status === 'succeeded') {
                        const img = box.querySelector('img');
                        const spinner = box.querySelector('.spinner-container');
                        
                        img.src = data.image_url;
                        img.onload = () => {
                            spinner.style.display = 'none';
                            box.classList.add('loaded');
                            setupImageControls(box, data.final_prompt, extractNationality(finalPrompt));
                        };
                    } else {
                        throw new Error(data.error || 'Generation failed');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert(error.message);
                    newGrid.remove();
                } finally {
                    createButton.disabled = false;
                }
            }
            
            // Inicializar estado del botón
            const createButton = document.getElementById('createPersona');
            createButton.disabled = true;
            
            // Event Listeners
            createButton?.addEventListener('click', generateImages);
        });

        // Añadir el manejo de eventos
        function setupImageControls(box, prompt, nationality) {
            const promptBtn = box.querySelector('.prompt-btn');
            const flagBtn = box.querySelector('.flag-btn');
            const zoomBtn = box.querySelector('.zoom-btn');
            const downloadBtn = box.querySelector('.download-btn');
            const removeBtn = box.querySelector('.remove-btn');
            const img = box.querySelector('img');

            // Configurar bandera y tooltip
            const countryCode = getCountryCode(nationality); // Función helper
            flagBtn.textContent = getFlagEmoji(countryCode);
            flagBtn.setAttribute('data-tooltip', nationality.replace('_', ' '));

            // Manejadores de eventos
            promptBtn.onclick = () => showPromptModal(prompt);
            zoomBtn.onclick = () => showImageModal(img.src);

            // Manejador para descargar imagen
            downloadBtn.addEventListener('click', () => {
                const link = document.createElement('a');
                link.href = img.src;
                link.download = `persona_${Date.now()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });

            // Manejador para eliminar imagen
            removeBtn.addEventListener('click', () => {
                box.closest('.preview-grid').remove();
            });
        }

        // Funciones helper
        function getFlagEmoji(countryCode) {
            const codePoints = countryCode
                .toUpperCase()
                .split('')
                .map(char => 127397 + char.charCodeAt());
            return String.fromCodePoint(...codePoints);
        }

         // Función helper para extraer nacionalidad del prompt
         function extractNationality(prompt) {
            const words = prompt.toLowerCase().split(' ');
            for (const word of words) {
                if (nationality_mapping && nationality_mapping[word]) {
                    return nationality_mapping[word];
                }
            }
            return 'unknown';
        }

        function showPromptModal(prompt) {
            const modal = document.querySelector('.prompt-modal');
            const cleanPrompt = prompt.split(',')
                .map(part => part.trim())
                .filter(part => part && part !== '')
                .join(',\n');
            
            modal.querySelector('.prompt-text').textContent = cleanPrompt;
            
            // Añadir funcionalidad de copiado
            const copyButton = modal.querySelector('.copy-button');
            copyButton.onclick = () => {
                navigator.clipboard.writeText(cleanPrompt);
                copyButton.textContent = '✅';
                setTimeout(() => copyButton.textContent = '📋', 2000);
            };
            
            modal.classList.add('active');
        }

        function showImageModal(src) {
            const modal = document.querySelector('.image-modal');
            modal.querySelector('img').src = src;
            modal.classList.add('active');
        }



// MAPEO PARA BANDERAS Y MODALES Definir el nationality_mapping al inicio del archivo
const nationality_mapping = {
    //Afganistán
    'afghan': 'afghanistan',
    'afghanistan': 'afghanistan',
    
    //Albania
    'albanian': 'albania',
    'albania': 'albania',
    
    //Argelia
    'algerian': 'algeria',
    'algeria': 'algeria',
    
    //Andorra
    'andorran': 'andorra',
    'andorra': 'andorra',
    
    //Angola
    'angolan': 'angola',
    'angola': 'angola',
    
    //Antigua y Barbuda
    'antiguan': 'antigua_and_barbuda',
    'antigua_and_barbuda': 'antigua_and_barbuda',
    
    //Argentina
    'argentinian': 'argentina',
    'argentina': 'argentina',
    
    //Armenia
    'armenian': 'armenia',
    'armenia': 'armenia',
    
    //Australia
    'australian': 'australia',
    'australia': 'australia',
    
    //Austria
    'austrian': 'austria',
    'austria': 'austria',
    
    //Azerbaiyán
    'azerbaijani': 'azerbaijan',
    'azerbaijan': 'azerbaijan',
    
    //Bahamas
    'bahamian': 'bahamas',
    'bahamas': 'bahamas',
    
    //Bahrein
    'bahraini': 'bahrain',
    'bahrain': 'bahrain',
    
    //Bangladesh
    'bangladeshi': 'bangladesh',
    'bangladesh': 'bangladesh',
    
    //Barbados
    'barbadian': 'barbados',
    'barbados': 'barbados',
    
    //Bielorrusia
    'belarusian': 'belarus',
    'belarus': 'belarus',
    
    //Bélgica
    'belgian': 'belgium',
    'belgium': 'belgium',
    
    //Belice
    'belizean': 'belize',
    'belize': 'belize',
    
    //Benin
    'beninese': 'benin',
    'benin': 'benin',
    
    //Bhután
    'bhutanese': 'bhutan',
    'bhutan': 'bhutan',
    
    //Bolivia
    'bolivian': 'bolivia',
    'bolivia': 'bolivia',
    
    //Bosnia y Herzegovina
    'bosnian': 'bosnia_and_herzegovina',
    'bosnia_and_herzegovina': 'bosnia_and_herzegovina',
    
    //Botswana
    'botswanan': 'botswana',
    'botswana': 'botswana',
    
    //Brasil
    'brazilian': 'brazil',
    'brazil': 'brazil',
    
    //Brunei
    'bruneian': 'brunei',
    'brunei': 'brunei',
    
    //Bulgaria
    'bulgarian': 'bulgaria',
    'bulgaria': 'bulgaria',
    
    //Burkina Faso
    'burkinabe': 'burkina_faso',
    'burkina_faso': 'burkina_faso',
    
    //Burundi
    'burundian': 'burundi',
    'burundi': 'burundi',
    
    //Camboya
    'cambodian': 'cambodia',
    'cambodia': 'cambodia',
    
    //Camerún
    'cameroonian': 'cameroon',
    'cameroon': 'cameroon',
    
    //Canadá
    'canadian': 'canada',
    'canada': 'canada',
    
    //Cabo Verde
    'cape_verdean': 'cape_verde',
    'cape_verde': 'cape_verde',
    
    //República Centroafricana
    'central_african': 'central_african_republic',
    'central_african_republic': 'central_african_republic',
    
    //Chad
    'chadian': 'chad',
    'chad': 'chad',
    
    //Chile
    'chilean': 'chile',
    'chile': 'chile',
    
    //China
    'chinese': 'china',
    'china': 'china',
    
    //Colombia
    'colombian': 'colombia',
    'colombia': 'colombia',
    
    //Comoras
    'comorian': 'comoros',
    'comoros': 'comoros',
    
    //Congo
    'congolese': 'congo',
    'congo': 'congo',
    
    //Costa Rica
    'costa_rican': 'costa_rica',
    'costa_rica': 'costa_rica',
    
    //Croacia
    'croatian': 'croatia',
    'croatia': 'croatia',
    
    //Cuba
    'cuban': 'cuba',
    'cuba': 'cuba',
    
    //Chipre
    'cypriot': 'cyprus',
    'cyprus': 'cyprus',
    
    //República Checa
    'czech': 'czech_republic',
    'czech_republic': 'czech_republic',
    
    //Dinamarca
    'danish': 'denmark',
    'denmark': 'denmark',
    
    //Yibuti
    'djiboutian': 'djibouti',
    'djibouti': 'djibouti',
    
    //Dominica
    'dominican': 'dominica',
    'dominica': 'dominica',
    
    //República Dominicana
    'dominican_republic': 'dominican_republic',
    
    //Timor Oriental
    'east_timorese': 'east_timor',
    'east_timor': 'east_timor',
    
    //Ecuador
    'ecuadorian': 'ecuador',
    'ecuador': 'ecuador',
    
    //Egipto
    'egyptian': 'egypt',
    'egypt': 'egypt',
    
    //El Salvador
    'salvadoran': 'el_salvador',
    'el_salvador': 'el_salvador',
    
    //Guinea Ecuatorial
    'equatorial_guinean': 'equatorial_guinea',
    'equatorial_guinea': 'equatorial_guinea',
    
    //Eritrea
    'eritrean': 'eritrea',
    'eritrea': 'eritrea',
    
    //Estonia
    'estonian': 'estonia',
    'estonia': 'estonia',
    
    //Etiopía
    'ethiopian': 'ethiopia',
    'ethiopia': 'ethiopia',
    
    //Fiji
    'fijian': 'fiji',
    'fiji': 'fiji',
    
    //Finlandia
    'finnish': 'finland',
    'finland': 'finland',
    
    //Francia
    'french': 'france',
    'france': 'france',
    
    //Gabón
    'gabonese': 'gabon',
    'gabon': 'gabon',
    
    //Gambia
    'gambian': 'gambia',
    'gambia': 'gambia',
    
    //Georgia
    'georgian': 'georgia',
    'georgia': 'georgia',
    
    //Alemania
    'german': 'germany',
    'germany': 'germany',
    
    //Ghana
    'ghanaian': 'ghana',
    'ghana': 'ghana',
    
    //Grecia
    'greek': 'greece',
    'greece': 'greece',
    
    //Granada
    'grenadian': 'grenada',
    'grenada': 'grenada',
    
    //Guatemala
    'guatemalan': 'guatemala',
    'guatemala': 'guatemala',
    
    //Guinea
    'guinean': 'guinea',
    'guinea': 'guinea',
    
    //Guinea-Bissau
    'bissau_guinean': 'guinea_bissau',
    'guinea_bissau': 'guinea_bissau',
    
    //Guyana
    'guyanese': 'guyana',
    'guyana': 'guyana',
    
    //Haití
    'haitian': 'haiti',
    'haiti': 'haiti',
    
    //Honduras
    'honduran': 'honduras',
    'honduras': 'honduras',
    
    //Hungría
    'hungarian': 'hungary',
    'hungary': 'hungary',
    
    //Islandia
    'icelandic': 'iceland',
    'iceland': 'iceland',
    
    //India
    'indian': 'india',
    'india': 'india',
    
    //Indonesia
    'indonesian': 'indonesia',
    'indonesia': 'indonesia',
    
    //Irán
    'iranian': 'iran',
    'iran': 'iran',
    
    //Iraq
    'iraqi': 'iraq',
    'iraq': 'iraq',
    
    //Irlanda
    'irish': 'ireland',
    'ireland': 'ireland',
    
    //Israel
    'israeli': 'israel',
    'israel': 'israel',
    
    //Italia
    'italian': 'italy',
    'italy': 'italy',
    
    //Jamaica
    'jamaican': 'jamaica',
    'jamaica': 'jamaica',
    
    //Japón
    'japanese': 'japan',
    'japan': 'japan',
    
    //Jordania
    'jordanian': 'jordan',
    'jordan': 'jordan',
    
    //Kazajistán
    'kazakh': 'kazakhstan',
    'kazakhstan': 'kazakhstan',
    
    //Kenia
    'kenyan': 'kenya',
    'kenya': 'kenya',
    
    //Kiribati
    'i_kiribati': 'kiribati',
    'kiribati': 'kiribati',
    
    //Corea del Norte
    'north_korean': 'north_korea',
    'north_korea': 'north_korea',
    
    //Corea del Sur
    'south_korean': 'south_korea',
    'south_korea': 'south_korea',
    
    //Kuwait
    'kuwaiti': 'kuwait',
    'kuwait': 'kuwait',
    
    //Kirguistán
    'kyrgyz': 'kyrgyzstan',
    'kyrgyzstan': 'kyrgyzstan',
    
    //Laos
    'laotian': 'laos',
    'laos': 'laos',
    
    //Letonia
    'latvian': 'latvia',
    'latvia': 'latvia',
    
    //Líbano
    'lebanese': 'lebanon',
    'lebanon': 'lebanon',
    
    //Lesoto
    'basotho': 'lesotho',
    'lesotho': 'lesotho',
    
    //Liberia
    'liberian': 'liberia',
    'liberia': 'liberia',
    
    //Libia
    'libyan': 'libya',
    'libya': 'libya',
    
    //Liechtenstein
    'liechtensteiner': 'liechtenstein',
    'liechtenstein': 'liechtenstein',
    
    //Lituania
    'lithuanian': 'lithuania',
    'lithuania': 'lithuania',
    
    //Luxemburgo
    'luxembourger': 'luxembourg',
    'luxembourg': 'luxembourg',
    
    //Macedonia del Norte
    'macedonian': 'north_macedonia',
    'north_macedonia': 'north_macedonia',
    
    //Madagascar
    'malagasy': 'madagascar',
    'madagascar': 'madagascar',
    
    //Malawi
    'malawian': 'malawi',
    'malawi': 'malawi',
    
    //Malasia
    'malaysian': 'malaysia',
    'malaysia': 'malaysia',
    
    //Maldivas
    'maldivian': 'maldives',
    'maldives': 'maldives',
    
    //Mali
    'malian': 'mali',
    'mali': 'mali',
    
    //Malta
    'maltese': 'malta',
    'malta': 'malta',
    
    //Islas Marshall
    'marshallese': 'marshall_islands',
    'marshall_islands': 'marshall_islands',
    
    //Mauritania
    'mauritanian': 'mauritania',
    'mauritania': 'mauritania',
    
    //Mauricio
    'mauritian': 'mauritius',
    'mauritius': 'mauritius',
    
    //México
    'mexican': 'mexico',
    'mexico': 'mexico',
    
    //Micronesia
    'micronesian': 'micronesia',
    'micronesia': 'micronesia',
    
    //Moldavia
    'moldovan': 'moldova',
    'moldova': 'moldova',
    
    //Mónaco
    'monacan': 'monaco',
    'monaco': 'monaco',
    
    //Mongolia
    'mongolian': 'mongolia',
    'mongolia': 'mongolia',
    
    //Montenegro
    'montenegrin': 'montenegro',
    'montenegro': 'montenegro',
    
    //Marruecos
    'moroccan': 'morocco',
    'morocco': 'morocco',
    
    //Mozambique
    'mozambican': 'mozambique',
    'mozambique': 'mozambique',
    
    //Myanmar (Birmania)
    'myanmar': 'myanmar',
    'burmese': 'myanmar',
    
    //Namibia
    'namibian': 'namibia',
    'namibia': 'namibia',
    
    //Nauru
    'nauruan': 'nauru',
    'nauru': 'nauru',
    
    //Nepal
    'nepalese': 'nepal',
    'nepali': 'nepal',
    'nepal': 'nepal',
    
    //Países Bajos
    'dutch': 'netherlands',
    'netherlands': 'netherlands',
    
    //Nueva Zelanda
    'new_zealander': 'new_zealand',
    'new_zealand': 'new_zealand',
    
    //Nicaragua
    'nicaraguan': 'nicaragua',
    'nicaragua': 'nicaragua',
    
    //Níger
    'nigerien': 'niger',
    'niger': 'niger',
    
    //Nigeria
    'nigerian': 'nigeria',
    'nigeria': 'nigeria',
    
    //Noruega
    'norwegian': 'norway',
    'norway': 'norway',
    
    //Omán
    'omani': 'oman',
    'oman': 'oman',
    
    //Pakistán
    'pakistani': 'pakistan',
    'pakistan': 'pakistan',
    
    //Palau
    'palauan': 'palau',
    'palau': 'palau',
    
    //Palestina
    'palestinian': 'palestine',
    'palestine': 'palestine',
    
    //Panamá
    'panamanian': 'panama',
    'panama': 'panama',
    
    //Papúa Nueva Guinea
    'papua_new_guinean': 'papua_new_guinea',
    'papua_new_guinea': 'papua_new_guinea',
    
    //Paraguay
    'paraguayan': 'paraguay',
    'paraguay': 'paraguay',
    
    //Perú
    'peruvian': 'peru',
    'peru': 'peru',
    
    //Filipinas
    'filipino': 'philippines',
    'philippines': 'philippines',
    
    //Polonia
    'polish': 'poland',
    'poland': 'poland',
    
    //Portugal
    'portuguese': 'portugal',
    'portugal': 'portugal',
    
    //Qatar
    'qatari': 'qatar',
    'qatar': 'qatar',
    
    //Rumania
    'romanian': 'romania',
    'romania': 'romania',
    
    //Rusia
    'russian': 'russia',
    'russia': 'russia',
    
    //Ruanda
    'rwandan': 'rwanda',
    'rwanda': 'rwanda',
    
    //San Cristóbal y Nieves
    'kittitian': 'saint_kitts_and_nevis',
    'saint_kitts_and_nevis': 'saint_kitts_and_nevis',
    
    //Santa Lucía
    'saint_lucian': 'saint_lucia',
    'saint_lucia': 'saint_lucia',
    
    //San Vicente y las Granadinas
    'vincentian': 'saint_vincent_and_the_grenadines',
    'saint_vincent_and_the_grenadines': 'saint_vincent_and_the_grenadines',
    
    //Samoa
    'samoan': 'samoa',
    'samoa': 'samoa',
    
    //San Marino
    'sammarinese': 'san_marino',
    'san_marino': 'san_marino',
    
    //Santo Tomé y Príncipe
    'sao_tomean': 'sao_tome_and_principe',
    'sao_tome_and_principe': 'sao_tome_and_principe',
    
    //Arabia Saudita
    'saudi': 'saudi_arabia',
    'saudi_arabia': 'saudi_arabia',
    
    //Senegal
    'senegalese': 'senegal',
    'senegal': 'senegal',
    
    //Serbia
    'serbian': 'serbia',
    'serbia': 'serbia',
    
    //Seychelles
    'seychellois': 'seychelles',
    'seychelles': 'seychelles',
    
    //Sierra Leona
    'sierra_leonean': 'sierra_leone',
    'sierra_leone': 'sierra_leone',
    
    //Singapur
    'singaporean': 'singapore',
    'singapore': 'singapore',
    
    //Eslovaquia
    'slovak': 'slovakia',
    'slovakia': 'slovakia',
    
    //Eslovenia
    'slovenian': 'slovenia',
    'slovenia': 'slovenia',
    
    //Islas Salomón
    'solomon_islander': 'solomon_islands',
    'solomon_islands': 'solomon_islands',
    
    //Somalia
    'somali': 'somalia',
    'somalia': 'somalia',
    
    //Sudáfrica
    'south_african': 'south_africa',
    'south_africa': 'south_africa',
    
    //Sudán del Sur
    'south_sudanese': 'south_sudan',
    'south_sudan': 'south_sudan',
    
    //España
    'spanish': 'spain',
    'spain': 'spain',
    
    //Sri Lanka
    'sri_lankan': 'sri_lanka',
    'sri_lanka': 'sri_lanka',
    
    //Sudán
    'sudanese': 'sudan',
    'sudan': 'sudan',
    
    //Surinam
    'surinamese': 'suriname',
    'suriname': 'suriname',
    
    //Suecia
    'swedish': 'sweden',
    'sweden': 'sweden',
    
    //Suiza
    'swiss': 'switzerland',
    'switzerland': 'switzerland',
    
    //Siria
    'syrian': 'syria',
    'syria': 'syria',
    
    //Taiwán
    'taiwanese': 'taiwan',
    'taiwan': 'taiwan',
    
    //Tayikistán
    'tajik': 'tajikistan',
    'tajikistan': 'tajikistan',
    
    //Tanzania
    'tanzanian': 'tanzania',
    'tanzania': 'tanzania',
    
    //Tailandia
    'thai': 'thailand',
    'thailand': 'thailand',
    
    //Togo
    'togolese': 'togo',
    'togo': 'togo',
    
    //Tonga
    'tongan': 'tonga',
    'tonga': 'tonga',
    
    //Trinidad y Tobago
    'trinidadian': 'trinidad_and_tobago',
    'trinidad_and_tobago': 'trinidad_and_tobago',
    
    //Túnez
    'tunisian': 'tunisia',
    'tunisia': 'tunisia',
    
    //Turquía
    'turkish': 'turkey',
    'turkey': 'turkey',
    
    //Turkmenistán
    'turkmen': 'turkmenistan',
    'turkmenistan': 'turkmenistan',
    
    //Tuvalu
    'tuvaluan': 'tuvalu',
    'tuvalu': 'tuvalu',
    
    //Uganda
    'ugandan': 'uganda',
    'uganda': 'uganda',
    
    //Ucrania
    'ukrainian': 'ukraine',
    'ukraine': 'ukraine',
    
    //Emiratos Árabes Unidos
    'emirati': 'united_arab_emirates',
    'united_arab_emirates': 'united_arab_emirates',
    
    //Variaciones para inglés/británico
    "english": "united_kingdom",
    "british": "united_kingdom",
    "uk": "united_kingdom",
    "united_kingdom": "united_kingdom",

    //Ciudades UK
    "london": "united_kingdom",
    "manchester": "united_kingdom",
    "liverpool": "united_kingdom",
    "birmingham": "united_kingdom",
    "leeds": "united_kingdom",
    "glasgow": "united_kingdom",
    "edinburgh": "united_kingdom",
    "cardiff": "united_kingdom",
    "belfast": "united_kingdom",
    "sheffield": "united_kingdom",
    "bristol": "united_kingdom",
    "oxford": "united_kingdom",
    "nottingham": "united_kingdom",
    "leicester": "united_kingdom",
    "coventry": "united_kingdom",
    "peterborough": "united_kingdom",
    "wolverhampton": "united_kingdom",
    "swansea": "united_kingdom",
    "newcastle": "united_kingdom",
    "bournemouth": "united_kingdom",
    "brighton": "united_kingdom",
    "milton_keynes": "united_kingdom",
   
    
    //Variaciones para americano/estadounidense
    "american": "united_states",
    "usa": "united_states",
    "us": "united_states",
    "united_states": "united_states",

    //Ciudades USA
    "new_york": "united_states",
    "nyc": "united_states",
    "los_angeles": "united_states",
    "la": "united_states",
    "chicago": "united_states",
    "houston": "united_states",
    "miami": "united_states",
    "boston": "united_states",
    "seattle": "united_states",
    "san_francisco": "united_states",
    "las_vegas": "united_states",
    "washington": "united_states",
    "dallas": "united_states",
    "atlanta": "united_states",
    "philadelphia": "united_states",
    "san_diego": "united_states",
    "san_jose": "united_states",
    "austin": "united_states",
    "san_antonio": "united_states",
   


    //Reino Unido
    'british': 'united_kingdom',
    'uk': 'united_kingdom',
    'english': 'united_kingdom',
    'scottish': 'united_kingdom',
    'welsh': 'united_kingdom',
    'united_kingdom': 'united_kingdom',
    
    //Estados Unidos
    'american': 'united_states',
    'usa': 'united_states',
    'us': 'united_states',
    'united_states': 'united_states',
    
    //Uruguay
    'uruguayan': 'uruguay',
    'uruguay': 'uruguay',
    
    //Uzbekistán
    'uzbek': 'uzbekistan',
    'uzbekistan': 'uzbekistan',
    
    //Vanuatu
    'ni_vanuatu': 'vanuatu',
    'vanuatu': 'vanuatu',
    
    //Ciudad del Vaticano
    'vatican': 'vatican_city',
    'vatican_city': 'vatican_city',
    
    //Venezuela
    'venezuelan': 'venezuela',
    'venezuela': 'venezuela',
    
    //Vietnam
    'vietnamese': 'vietnam',
    'vietnam': 'vietnam',
    
    //Yemen
    'yemeni': 'yemen',
    'yemen': 'yemen',
    
    //Zambia
    'zambian': 'zambia',
    'zambia': 'zambia',
    
    //Zimbabue
    'zimbabwean': 'zimbabwe',
    'zimbabwe': 'zimbabwe'
}


    // Mapeo de países a códigos ISO
    const countryToISO = {
        'afghanistan': 'af',
        'albania': 'al',
        'algeria': 'dz',
        'andorra': 'ad',
        'angola': 'ao',
        'argentina': 'ar',
        'armenia': 'am',
        'australia': 'au',
        'austria': 'at',
        'azerbaijan': 'az',
        'bahamas': 'bs',
        'bahrain': 'bh',
        'bangladesh': 'bd',
        'belarus': 'by',
        'belgium': 'be',
        'belize': 'bz',
        'benin': 'bj',
        'bhutan': 'bt',
        'bolivia': 'bo',
        'bosnia_and_herzegovina': 'ba',
        'brazil': 'br',
        'brunei': 'bn',
        'bulgaria': 'bg',
        'burkina_faso': 'bf',
        'burundi': 'bi',
        'cambodia': 'kh',
        'cameroon': 'cm',
        'canada': 'ca',
        'chile': 'cl',
        'china': 'cn',
        'colombia': 'co',
        'congo': 'cg',
        'costa_rica': 'cr',
        'croatia': 'hr',
        'cuba': 'cu',
        'cyprus': 'cy',
        'czech_republic': 'cz',
        'denmark': 'dk',
        'ecuador': 'ec',
        'egypt': 'eg',
        'el_salvador': 'sv',
        'estonia': 'ee',
        'ethiopia': 'et',
        'fiji': 'fj',
        'finland': 'fi',
        'france': 'fr',
        'georgia': 'ge',
        'germany': 'de',
        'ghana': 'gh',
        'greece': 'gr',
        'guatemala': 'gt',
        'haiti': 'ht',
        'honduras': 'hn',
        'hungary': 'hu',
        'iceland': 'is',
        'india': 'in',
        'indonesia': 'id',
        'iran': 'ir',
        'iraq': 'iq',
        'ireland': 'ie',
        'israel': 'il',
        'italy': 'it',
        'jamaica': 'jm',
        'japan': 'jp',
        'jordan': 'jo',
        'kazakhstan': 'kz',
        'kenya': 'ke',
        'kuwait': 'kw',
        'kyrgyzstan': 'kg',
        'laos': 'la',
        'latvia': 'lv',
        'lebanon': 'lb',
        'libya': 'ly',
        'liechtenstein': 'li',
        'lithuania': 'lt',
        'luxembourg': 'lu',
        'madagascar': 'mg',
        'malaysia': 'my',
        'maldives': 'mv',
        'mali': 'ml',
        'malta': 'mt',
        'mexico': 'mx',
        'moldova': 'md',
        'monaco': 'mc',
        'mongolia': 'mn',
        'montenegro': 'me',
        'morocco': 'ma',
        'mozambique': 'mz',
        'myanmar': 'mm',
        'nepal': 'np',
        'netherlands': 'nl',
        'new_zealand': 'nz',
        'nicaragua': 'ni',
        'nigeria': 'ng',
        'north_korea': 'kp',
        'norway': 'no',
        'oman': 'om',
        'pakistan': 'pk',
        'panama': 'pa',
        'paraguay': 'py',
        'peru': 'pe',
        'philippines': 'ph',
        'poland': 'pl',
        'portugal': 'pt',
        'qatar': 'qa',
        'romania': 'ro',
        'russia': 'ru',
        'saudi_arabia': 'sa',
        'senegal': 'sn',
        'serbia': 'rs',
        'singapore': 'sg',
        'slovakia': 'sk',
        'slovenia': 'si',
        'somalia': 'so',
        'south_africa': 'za',
        'south_korea': 'kr',
        'spain': 'es',
        'sri_lanka': 'lk',
        'sudan': 'sd',
        'sweden': 'se',
        'switzerland': 'ch',
        'syria': 'sy',
        'taiwan': 'tw',
        'tajikistan': 'tj',
        'tanzania': 'tz',
        'thailand': 'th',
        'tunisia': 'tn',
        'turkey': 'tr',
        'turkmenistan': 'tm',
        'uganda': 'ug',
        'ukraine': 'ua',
        'united_arab_emirates': 'ae',
        'united_kingdom': 'gb',
        'united_states': 'us',
        'uruguay': 'uy',
        'uzbekistan': 'uz',
        'venezuela': 've',
        'vietnam': 'vn',
        'yemen': 'ye',
        'zambia': 'zm',
        'zimbabwe': 'zw'
    };

    // Función helper para obtener el código de país
    function getCountryCode(nationality) {
        return countryToISO[nationality] || nationality.substring(0, 2);
    }

    // Añadir manejo de cierre de modales
    document.querySelectorAll('.modal-close').forEach(button => {
        button.onclick = () => {
            button.closest('.modal').classList.remove('active');
        };
    });

    // Cerrar modal al hacer clic fuera
    document.querySelectorAll('.modal').forEach(modal => {
        modal.onclick = (e) => {
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        };
    });

    // Añadir después de DOMContentLoaded
    document.getElementById('pdfFile').addEventListener('change', async function(e) {
        if (this.files.length > 0) {
            const file = this.files[0];
            
            // Mostrar nombre del archivo y estado
            const fileName = document.querySelector('.file-name');
            fileName.textContent = file.name;
            const pdfStatus = document.querySelector('.pdf-status');
            pdfStatus.style.display = 'flex';
            
            // Mostrar barra de progreso
            const pdfProgress = document.querySelector('.pdf-progress');
            pdfProgress.style.display = 'block';
            const progressBar = document.querySelector('.progress-fill');
            progressBar.style.width = '30%';
            const progressText = document.querySelector('.progress-text');
            progressText.textContent = 'Uploading PDF...';

            const formData = new FormData();
            formData.append('pdf', file);
            
            try {
                progressBar.style.width = '60%';
                progressText.textContent = 'Analyzing content...';
                
                const response = await fetch('/analyze-pdf', {
                    method: 'POST',
                    body: formData
                });
                
                progressBar.style.width = '90%';
                progressText.textContent = 'Generating summary...';
                
                const data = await response.json();
                if (data.prompt) {
                    const pdfPromptText = data.prompt;
                    progressBar.style.width = '100%';
                    progressText.textContent = 'Ready!';
                    pdfProgress.classList.add('success');
                    
                    // Actualizar el prompt en el textarea
                    const promptInput = document.getElementById('personaPrompt');
                    promptInput.value = pdfPromptText;
                    
                    // Mostrar información detectada
                    const promptInfo = document.createElement('div');
                    promptInfo.className = 'prompt-info';
                    promptInfo.innerHTML = `
                        <p>${data.detected_info.nationality}</p>
                        <p>${data.detected_info.ethnicity}</p>
                    `;
                    pdfProgress.appendChild(promptInfo);
                }
            } catch (error) {
                console.error('Error:', error);
                progressText.textContent = 'Error processing PDF';
                progressBar.style.backgroundColor = '#ff4444';
            }
        }
    });

    // Manejar eliminación del PDF
    const removeButton = document.querySelector('.remove-pdf');
    removeButton.addEventListener('click', () => {
        const pdfFile = document.getElementById('pdfFile');
        pdfFile.value = '';
        const pdfStatus = document.querySelector('.pdf-status');
        pdfStatus.style.display = 'none';
        const pdfProgress = document.querySelector('.pdf-progress');
        pdfProgress.classList.remove('success');
        pdfProgress.style.display = 'none';
        const progressBar = document.querySelector('.progress-fill');
        progressBar.style.width = '0%';
        document.getElementById('personaPrompt').value = '';
    });

    </script>
</body>
</html>